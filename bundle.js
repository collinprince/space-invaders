(()=>{"use strict";var e={366:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEnemyMissile=void 0;const s=i(507);class a extends s.GameObject{constructor(e,t){super(e.x,e.y,5,5,0,3,n,{isAlive:h}),this.maxY=t}}function n(e){e.fillRect(this.x,this.y,this.width,this.height)}function h(){return this.alive&&this.y<this.maxY}t.createEnemyMissile=(e,t)=>new a(e,t)},520:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEnemyShip=void 0;const s=i(507);class a extends s.GameObject{constructor(e){super(e.x,e.y,20,20,.5,0,n,{updatePosition:h}),this.internalClock=0}}function n(e){e.strokeStyle="white",e.fillStyle="red",e.beginPath(),e.moveTo(this.x,this.y),e.lineTo(this.x+this.width/2,this.y+this.height),e.lineTo(this.x+this.width,this.y),e.lineTo(this.x+this.width/2,this.y+this.height/4),e.closePath(),e.fill(),e.stroke()}function h(){this.x+=this.dx,this.internalClock+=1,40==this.internalClock&&(this.internalClock=0,this.dx=-this.dx)}t.createEnemyShip=e=>new a(e)},507:(e,t)=>{function i(){return this.alive}function s(){this.x+=this.dx,this.y+=this.dy}Object.defineProperty(t,"__esModule",{value:!0}),t.GameObject=void 0,t.GameObject=class{constructor(e,t,a,n,h,l,r,{updatePosition:o=s,isAlive:y=i}={updatePosition:s,isAlive:i}){this.x=e,this.y=t,this.width=a,this.height=n,this.dx=h,this.dy=l,this.draw=r,this.updatePosition=o,this.isAlive=y,this.alive=!0}setX(e){this.x=e}setY(e){this.y=e}setDx(e){this.dx=e}setDy(e){this.dy=e}setPosition(e,t){this.setX(e),this.setY(t)}setDirection(e,t){this.setDx(e),this.setDy(t)}}},10:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPlayerMissile=void 0;const s=i(507),a=i(212),n=i(810);function h(e){let t={x:this.x+this.width/2,y:this.y},i={x:this.x+this.width,y:this.y+this.height},s={x:this.x,y:this.y+this.height};e.fillStyle="blue",(0,a.drawTriangleFill)(e,t,i,s)}function l(){return this.alive&&this.y>0}t.createPlayerMissile=e=>{let t={x:e.x+n.PLAYER_SHIP_WIDTH/2-2.5,y:e.y-10};return new s.GameObject(t.x,t.y,5,10,0,-10,h,{isAlive:l})}},810:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPlayerShip=t.PlayerShip=t.STARTING_NUM_LIVES=t.PLAYER_MOVING_SPEED=t.PLAYER_SHIP_HEIGHT=t.PLAYER_SHIP_WIDTH=void 0;const s=i(507);t.PLAYER_SHIP_WIDTH=20,t.PLAYER_SHIP_HEIGHT=30,t.PLAYER_MOVING_SPEED=5,t.STARTING_NUM_LIVES=3;class a extends s.GameObject{constructor(e){super(e.x,e.y,t.PLAYER_SHIP_WIDTH,t.PLAYER_SHIP_HEIGHT,0,0,n,{updatePosition:h,isAlive:l}),this.numLives=t.STARTING_NUM_LIVES}decrementLives(){this.numLives-=1}}function n(e){e.fillStyle="blue",e.beginPath(),e.moveTo(this.x,this.y+this.height),e.lineTo(this.x,this.y+this.height/2),e.lineTo(this.x+this.width/5,this.y+this.height/2),e.lineTo(this.x+this.width/5,this.y+this.height*(5/8)),e.lineTo(this.x+.45*this.width,this.y),e.lineTo(this.x+.55*this.width,this.y),e.lineTo(this.x+.8*this.width,this.y+this.height*(5/8)),e.lineTo(this.x+.8*this.width,this.y+this.height/2),e.lineTo(this.x+this.width,this.y+this.height/2),e.lineTo(this.x+this.width,this.y+this.height),e.lineTo(this.x+.8*this.width,this.y+this.height),e.lineTo(this.x+.8*this.width,this.y+this.height*(7/8)),e.lineTo(this.x+.2*this.width,this.y+this.height*(7/8)),e.lineTo(this.x+.2*this.width,this.y+this.height),e.closePath(),e.fill(),e.stroke()}function h(e,t){this.x+=this.dx,this.x<0&&(this.x=0),this.x+this.width>=e&&(this.x=e-this.width)}function l(){return this.numLives>0}t.PlayerShip=a,t.createPlayerShip=e=>new a(e)},829:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.parseKey=t.Key=void 0,function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Spacebar=2]="Spacebar",e[e.NoOp=3]="NoOp"}(i=t.Key||(t.Key={})),t.parseKey=e=>{return"ArrowLeft"===(t=e.key)||"Left"===t?i.Left:(e=>"ArrowRight"===e||"Right"===e)(e.key)?i.Right:(e=>" "===e||"Spacebar"===e)(e.key)?i.Spacebar:i.NoOp;var t}},796:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.objectsAreColliding=void 0;const i=(e,t)=>e.start<t.start?e:t,s=(e,t)=>e.start<t.start?t:e;t.objectsAreColliding=(e,t)=>{const a={start:e.x,end:e.x+e.width},n={start:e.y,end:e.y+e.height},h={start:t.x,end:t.x+t.width},l={start:t.y,end:t.y+t.width},r=[i(a,h),s(a,h)],o=[i(n,l),s(n,l)],y=r[0].end>=r[1].start,d=o[0].end>=o[1].start;return y&&d}},531:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textHeight=t.textWidth=t.textDimensions=t.writeText=void 0,t.writeText=(e,t,i,s="20px Arial",a="white")=>{e.fillStyle=a,e.font=s,e.fillText(t,i.x,i.y)},t.textDimensions=(e,t,i="20px Arial")=>{e.font=i;const s=e.measureText(t);return{width:Math.abs(s.actualBoundingBoxLeft)+Math.abs(s.actualBoundingBoxRight),height:Math.abs(s.actualBoundingBoxAscent)+Math.abs(s.actualBoundingBoxDescent)}},t.textWidth=(e,i,s="20px Arial")=>(0,t.textDimensions)(e,i,s).width,t.textHeight=(e,i,s="20px Arial")=>(0,t.textDimensions)(e,i,s).height},315:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.displayText=void 0;const s=i(54),a=i(531);t.displayText=(e,t,i)=>{const{canvasWidth:n,canvasHeight:h}=i;if(t.gameMode===s.GameMode.Start){const t="SPACE INVADERS",i="Press spacebar to begin.",s=(0,a.textDimensions)(e,t),l=(0,a.textWidth)(e,i),r=10;(0,a.writeText)(e,t,{x:n/2-s.width/2,y:h/2-s.height/2}),(0,a.writeText)(e,i,{x:n/2-l/2,y:h/2+s.height/2+r})}else if(t.gameMode===s.GameMode.Play)(0,a.writeText)(e,`Enemies remaining: ${t.enemies.length}`,{x:10,y:20}),(0,a.writeText)(e,`Lives remaining: ${t.player.numLives}`,{x:10,y:50});else if(t.gameMode===s.GameMode.Won){const t="YOU WON!",i="Press spacebar to play again.",s=(0,a.textDimensions)(e,t),l=(0,a.textWidth)(e,i),r=10;(0,a.writeText)(e,t,{x:n/2-s.width/2,y:h/2-s.height/2}),(0,a.writeText)(e,i,{x:n/2-l/2,y:h/2+s.height/2+r})}else{const t="GAME OVER!",i="Press spacebar to play again.",s=(0,a.textDimensions)(e,t),l=(0,a.textWidth)(e,i),r=10;(0,a.writeText)(e,t,{x:n/2-s.width/2,y:h/2-s.height/2}),(0,a.writeText)(e,i,{x:n/2-l/2,y:h/2+s.height/2+r})}}},212:(e,t)=>{function i(e,t,i,s,a){e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.lineTo(s.x,s.y),e.closePath(),a&&e.fill(),e.stroke()}Object.defineProperty(t,"__esModule",{value:!0}),t.drawCircle=t.drawTriangleOutline=t.drawTriangleFill=void 0,t.drawTriangleFill=(e,t,s,a)=>i(e,t,s,a,!0),t.drawTriangleOutline=(e,t,s,a)=>i(e,t,s,a,!1),t.drawCircle=function(e,t,i){e.beginPath(),e.arc(t.x,t.y,i,0,2*Math.PI),e.stroke()}},54:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.gameStateMachineUpdate=t.clearDeadGameObjectsFromWorld=t.detectEnemyMissileAndPlayerShipCollisions=t.detectPlayerMissileAndEnemyShipCollisions=t.randomlyGenerateEnemyMissiles=t.drawAndUpdateWorld=t.init=t.GameMode=void 0;const s=i(810),a=i(796),n=i(810),h=i(520),l=i(366),r=i(10),o=i(829);var y;!function(e){e[e.Start=0]="Start",e[e.Play=1]="Play",e[e.Won=2]="Won",e[e.Lost=3]="Lost"}(y=t.GameMode||(t.GameMode={})),t.init=({canvasWidth:e,canvasHeight:t},i)=>{let s={x:e/2-10,y:t-100};return{player:(0,n.createPlayerShip)(s),playerMissiles:new Array,enemies:new Array,enemyMissiles:new Array,maxX:e,maxY:t,gameMode:y.Start}},t.drawAndUpdateWorld=(e,t,i,s)=>{s.gameMode===y.Play&&(s.player.draw(e),s.player.updatePosition(t,i),[s.playerMissiles,s.enemies,s.enemyMissiles].forEach((s=>{s.forEach((s=>{s.draw(e),s.updatePosition(t,i)}))})))},t.randomlyGenerateEnemyMissiles=e=>{e.enemies.forEach((t=>{if(Math.random()<.001){let i={x:t.x+t.width/2,y:t.y+t.height};e.enemyMissiles.push((0,l.createEnemyMissile)(i,e.maxY))}}))},t.detectPlayerMissileAndEnemyShipCollisions=e=>{e.enemies.forEach((t=>{e.playerMissiles.forEach((e=>{(0,a.objectsAreColliding)(t,e)&&(t.alive=!1,e.alive=!1)}))}))},t.detectEnemyMissileAndPlayerShipCollisions=e=>{e.enemyMissiles.forEach((t=>{(0,a.objectsAreColliding)(e.player,t)&&(e.player.decrementLives(),t.alive=!1)}))},t.clearDeadGameObjectsFromWorld=e=>{[e.playerMissiles,e.enemies,e.enemyMissiles]=[e.playerMissiles,e.enemies,e.enemyMissiles].map((e=>e.filter((e=>e.isAlive()))))};const d=e=>e.gameMode=y.Start;t.gameStateMachineUpdate=(e,t,i)=>{if(e.gameMode===y.Start){if(t.keyDown===o.Key.Spacebar)return(e=>{e.gameMode=y.Play})(e),void((e,t)=>{let i={x:t.canvasWidth/2-10,y:t.canvasHeight-100};e.player.setPosition(i.x,i.y),e.player.numLives=s.STARTING_NUM_LIVES;for(let i=0;i<10;++i){let s={x:20+t.canvasWidth/10*i,y:t.canvasHeight/10};e.enemies.push((0,h.createEnemyShip)(s))}})(e,i)}else if(e.gameMode===y.Play){if(0===e.enemies.length)return void(e=>{e.gameMode=y.Won})(e);if(0===e.player.numLives)return void(e=>{e.gameMode=y.Lost})(e);if(t.keyDown===o.Key.Left)e.player.setDx(-s.PLAYER_MOVING_SPEED);else if(t.keyDown===o.Key.Right)e.player.setDx(s.PLAYER_MOVING_SPEED);else if(t.keyDown===o.Key.Spacebar){let t={x:e.player.x,y:e.player.y};e.playerMissiles.push((0,r.createPlayerMissile)(t))}(t.keyUp===o.Key.Left&&e.player.dx<0||t.keyUp===o.Key.Right&&e.player.dx>0)&&e.player.setDx(0)}else e.gameMode===y.Won?(e.playerMissiles=[],e.enemyMissiles=[],e.player.setDx(0),t.keyDown===o.Key.Spacebar&&d(e)):e.gameMode===y.Lost&&(e.playerMissiles=[],e.enemies=[],e.enemyMissiles=[],e.player.setDx(0),t.keyDown===o.Key.Spacebar&&d(e))}}},t={};function i(s){var a=t[s];if(void 0!==a)return a.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,i),n.exports}(()=>{const e=i(829),t=i(54),s=i(315),a=document.getElementById("canvas"),n=a.getContext("2d");let h={canvasWidth:a.width,canvasHeight:a.height},l=(0,t.init)(h,10);document.addEventListener("keydown",(i=>{(0,t.gameStateMachineUpdate)(l,{keyDown:(0,e.parseKey)(i),keyUp:e.Key.NoOp},h)})),document.addEventListener("keyup",(i=>{(0,t.gameStateMachineUpdate)(l,{keyDown:e.Key.NoOp,keyUp:(0,e.parseKey)(i)},h)})),function i(){const{canvasWidth:a,canvasHeight:r}=h;n.clearRect(0,0,a,r),n.fillStyle="black",n.fillRect(0,0,a,r),(0,t.gameStateMachineUpdate)(l,{keyDown:e.Key.NoOp,keyUp:e.Key.NoOp},h),(0,s.displayText)(n,l,h),(0,t.randomlyGenerateEnemyMissiles)(l),(0,t.drawAndUpdateWorld)(n,a,r,l),(0,t.detectPlayerMissileAndEnemyShipCollisions)(l),(0,t.detectEnemyMissileAndPlayerShipCollisions)(l),(0,t.clearDeadGameObjectsFromWorld)(l),requestAnimationFrame(i)}()})()})();